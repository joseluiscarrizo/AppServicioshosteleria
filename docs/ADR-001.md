# ADR-001: Arquitectura de Manejo Global de Errores

**Estado:** Aceptado  
**Fecha:** 2026-02-28  
**Autores:** Equipo de Desarrollo

---

## Contexto

La aplicación AppServicioshosteleria necesita una estrategia robusta para capturar, manejar y notificar errores en todos los niveles de la interfaz de usuario. Sin una capa centralizada de manejo de errores, los fallos de componentes individuales pueden colapsar toda la aplicación sin mostrar información útil al usuario.

## Decisión

Implementamos un sistema de manejo global de errores con tres capas:

1. **`ErrorBoundary` (clase React):** Captura errores de renderizado en el árbol de componentes y muestra `ErrorFallback` en lugar de colapsar la app.
2. **`ErrorFallback` (componente funcional):** UI amigable que muestra el mensaje de error y permite al usuario reintentar.
3. **`ErrorContext` / `useErrorHandler` (hook):** Gestión centralizada de errores en lógica de negocio (peticiones API, mutaciones). Usa `sonner` para mostrar notificaciones tipo toast.

### Estructura

```
App
└── ErrorBoundary              ← captura errores de renderizado
    └── ErrorProvider          ← contexto global de errores
        └── <App content>      ← useErrorHandler disponible en cualquier componente
```

## Consecuencias

**Positivo:**
- Los errores de renderizado no colapsan la aplicación completa.
- El usuario siempre recibe feedback visual cuando algo falla.
- Los errores se pueden centralizar para logging o integración con servicios externos.

**Negativo:**
- Requiere que los componentes usen `useErrorHandler` en lugar de manejo local de errores ad-hoc.

## Alternativas Consideradas

- **Sin ErrorBoundary:** Cualquier error de renderizado causaría un pantalla en blanco.
- **ErrorBoundary por página:** Más granular, pero requiere más configuración. Se puede adoptar en iteraciones futuras.
