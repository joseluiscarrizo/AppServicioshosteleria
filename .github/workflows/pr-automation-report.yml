name: PR Automation Report

on:
  schedule:
    - cron: '0 9 * * *'
  workflow_dispatch:

jobs:
  automation-report:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: read
      contents: read
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const { data: prs } = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'open',
              per_page: 100
            });

            const { data: merged } = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'closed',
              per_page: 30,
              sort: 'updated',
              direction: 'desc'
            });

            const recentMerges = merged.filter(pr => pr.merged_at).length;

            console.log('=== PR Automation Daily Report ===');
            console.log(`Date: ${new Date().toISOString()}`);
            console.log(`Open PRs: ${prs.length}`);
            console.log(`Recently closed/merged: ${recentMerges}`);
            console.log('==================================');
